//-----------------------------------------------------------------------------
// File : asdxResHDR.h
// Desc : HDR File Format.
// Copyright(c) Project Asura. All right reserved
//-----------------------------------------------------------------------------
#pragma once

//-----------------------------------------------------------------------------
// Includes
//-----------------------------------------------------------------------------
#include <cstdint>

//-----------------------------------------------------------------------------
// Forward Declarations.
//-----------------------------------------------------------------------------
struct RGBE;


namespace asdx {

///////////////////////////////////////////////////////////////////////////////
// ResHDR class
///////////////////////////////////////////////////////////////////////////////
class ResHDR
{
    //=========================================================================
    // list of friend classes and methods.
    //=========================================================================
    /* NOTHING */

public:
    //=========================================================================
    // public variables.
    //=========================================================================
    /* NOTHING */

    //=========================================================================
    // public methods.
    //=========================================================================

    //-------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //-------------------------------------------------------------------------
    ResHDR();

    //-------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //-------------------------------------------------------------------------
    ~ResHDR();

    //-------------------------------------------------------------------------
    //! @brief      ファイルから読み込みします.
    //!
    //! @param[in]      filename        ファイル名です.
    //! @retval true    読み込みに成功.
    //! @retval false   読み込みに失敗.
    //-------------------------------------------------------------------------
    bool Load(const wchar_t* filename);

    //-------------------------------------------------------------------------
    //! @brief      メモリを解放します.
    //-------------------------------------------------------------------------
    void Release();

    //-------------------------------------------------------------------------
    //! @brief      画像の横幅を取得します.
    //!
    //! @return     画像の横幅を返却します.
    //-------------------------------------------------------------------------
    const uint32_t GetWidth() const;

    //-------------------------------------------------------------------------
    //! @brief      画像の縦幅を取得します.
    //!
    //! @return     画像の横幅を返却します.
    //-------------------------------------------------------------------------
    const uint32_t GetHeight() const;

    //-------------------------------------------------------------------------
    //! @brief      露光値を取得します.
    //!
    //! @return     露光値を返却します.
    //-------------------------------------------------------------------------
    const float GetExposure() const;

    //-------------------------------------------------------------------------
    //! @brief      ピクセルデータを取得します.
    //!
    //! @return     RBGE形式のピクセルデータを返却します.
    //-------------------------------------------------------------------------
    const uint8_t* GetPixels() const;

    //-------------------------------------------------------------------------
    //! @brief      デコードされたピクセルデータを取得します.
    //!
    //! @param[out]     ppReuslt        浮動小数点RGB形式のピクセルデータを格納先です.
    //-------------------------------------------------------------------------
    void GetFloatPixels(float** ppResults) const;

protected:
    //=========================================================================
    // protected variables.
    //=========================================================================
    uint32_t    m_Width;        //!< 画像の横幅です.
    uint32_t    m_Height;       //!< 画像の縦幅です.
    float       m_Exposure;     //!< 露出値です.
    float       m_Gamma;        //!< ガンマ値です.
    RGBE*       m_pPixels;      //!< RGBEピクセルデータです.

    //=========================================================================
    // protected methods.
    //=========================================================================
    /* NOTHING */
};

} // namespace asdx
